First Presentation - Data Backgrounding

Guiding Question:
What early career stats help predict a player's upward or downward career trajectory over time? 

There are many subquestions that can be asked within this based on numerous factors. Is there a 'year' that players must be producing by until teams give up on them? Is instant success or gradual improvement better? What about their role/usage? 


I plan on using data from the 2003 season to the present day (had to include LeBron's rookie year), and collecting it from basketballreference. This website has pretty much everything I need, including advanced stats/metrics from every player. I probably won't need assistance in getting it, I will just figure out the best method to get all of this data into one place - ie. if one season per file is best, or if I should load them all into one big file. 

Basketballreference sometimes has some funky formatting, for example if a player played for multiple teams in a season, they have separate stats and then a total stat - there is a team classified as '2TM' that I will need to work through. They also have headers every 20 or so players, which will just be annoying to remove for every season. Advanced stats and usage stuff that I may use are also on a separate tab from the 'basic' stats, so combining those may be a struggle, too. Calculating someone's 'years pro' may be tough, too - I haven't been able to find it on the website.


*Some Harvard students did a similar study about player development in the NBA back in 2015 (link: https://harvardsportsanalysis.org/2015/05/player-progression-in-the-nba/). 

*A man did try to predict NBA success based on the first few years and used a number of different measures/presentations (I really liked his decision trees), it gave me a few ideas but also had some differences.  https://www.kaggle.com/code/tombutton/predicting-nba-success

MIT's Sloan school which runs a lot of Sports Analytics stuff also published a paper about predicting success for players using both their pre-NBA and NBA data using a lot of advanced statistics. They focused on something called relevance-based prediction. (https://mitsloan.mit.edu/shared/ods/documents?PublicationDocumentID=10079)

All of these pieces are similar to what I'm doing, but aren't exactly the same. It does provide me with some preliminary info on what may be good/bad but I also think that I have a bit of my own path to chart with this. 

I have tried a number of different ways to get NBA data from each season. I'm wondering if there are any preloaded packages that I may be able to use. It's especially important for me to have the 'years pro' section for each player. I have tried manually downloading each CSV file for each NBA season (I did so for about the most recent 5 seasons, but realized that it was going to be a bit tedious), and have also tried to use hoopR and nbastatR, but may need assistance in how to obtain data from the past 21 NBA seasons. Below are some attempts, but I'm not sure where it gets me. 

```{r}
install.packages("hoopR")
install.packages("tictoc")
```

```{r}
tictoc::tic()
progressr::with_progress({
  nba_pbp <- hoopR::load_nba_pbp(season = 2024)
})
tictoc::toc()
```

Load NBA 2024 season stats
```{r}
nba24 <- read_excel("~/Downloads/nba24.xlsx", 
+     sheet = "nba24")
```


```{r}
devtools::install_github("abresler/nbastatR", force = TRUE)
```
```{r}
library(nbastatR)
```




----------- 
**ASSIGNMENT 2: Exploration**

I found a github repository of someone who used rookie data to predict a binary response variable, which was just whether or not a player had a career of >5 years (https://github.com/amitabh-bhattacharya/Classification-of-NBA-Rookiee-career-length/blob/master/nba.csv), (https://data.world/exercises/logistic-regression-exercise-1). This does seem useful, but I envision something a bit more complex. I plan on having a "threshold" and organizing it by position and stat - a bunch of different charts would need to be created (ie. for PG's, the comparison of rookie year APG vs career APG) that are kind of categorized based on what we want to see (or what has the highest predictive ability). I need to think more about if there is one all-encompassing value that can equate to a successful career - that is something I will think about more moving forward. 

After doing some more resarch, basketballreference has a page where it includes rookie data and then a section of it that includes only their rookie data, then their career stats. I've determined that this will be the data to use. 

In order to work with this data's predictive abilities, I will work with past data and will tighten the window so I don't have to take a bunch of time downloading datasets. I will use data from all draftees between 2007 and 2018. 


First, we can load in the 2007 data - this comes in two different files - one file (that I titled "rookie") contains each 2007 rookie's season stats, and the other (titled "career") contains a 2007 rookie's career stats. 




```{r}
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)

rookie07 <- read_excel("/Users/sambenning/code/jour479x_fall_2024/presentations/2007rookie.xlsx", skip = 1)

career07 <- read_excel("/Users/sambenning/code/jour479x_fall_2024/presentations/2007career.xlsx", skip = 1)
```

```{r}
head(rookie07)

rookie07 |>
  summarize(total_rows = n())

career07 |>
  summarize(total_rows = n())
```
There are 64 rows in both of the data sets. It contains 30 columns that measure different statistics like FG, Steals/Blocks, etc.

It covers all 82 games of the 2007 season. 

```{r}

print(colnames(rookie07))

print(colnames(career07))

str(rookie07)
```

Big struggle that took a while to figure out: Since there are the same columns names for totals and per game stats, R renamed some stat columns using an ellipses and the column number of the repeated variable. Additionally, I have to use the same stat for both datasets. After looking it up, I found the "rename" function which helps rename a variable (shocker) so that I am not confused as to if I'm using an average or total stat. Then, I have to merge the data so that I can use ggplot to compare a season stat to a career stat. 
```{r}
rookie07 <- rookie07 |>
  rename(PPG_r = `PTS...26`) 

career07 <- career07 |>
  rename(PPG_c = `PTS...26`) 


merged_data07 <- merge(rookie07, career07)

```
Evem though it says the "rename" function isn't working, I can still check the data and I see that there is a PPG_r and PPG_c column. Very interesting - I am curious as to why this is. 
```{r}
head(merged_data07)
```


I figured it was most appropriate to include a scatterplot instead of a line chart, because while we are technically looking at things over time, we don't have statistics on the trends (that would be a lot of data to work with, though I wish I could). 
```{r}
ggplot(merged_data07, aes(x = PPG_r.x, y = PPG_r.y)) +
  geom_point() +
  labs(x = "PPG Rookie Yr", y = "PPG career", title = "Rookie vs Career Games Played") +
  theme_minimal()

```

I am also a bit frustrated that a player's team's aren't listed for their career stats. I wish I was able to see which teams developed players best and measure some other things. Additionally, their position is not included, so I can't group data by position to analyze as I would've wanted. Shucks. I may need to create a new guiding prompt/question to research - this is getting tougher as I learn more about the data. I may want to distribute by age (done below) to distribute and answer questions instead. Would like to discuss this if we get the chance. If not, I'm willing to make a shift and try to work with some other datasets or come up with some totally new questions. 

```{r}
rookie07 |>
  group_by(Age) |>
  summarize(
    num_players = n()
    )
```